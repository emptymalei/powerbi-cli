{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Power BI CLI Tool","text":"<p><code>pbi_cli</code> is a CLI tool for Power BI written in Python.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"references/","title":"References","text":"<p>References for <code>pbi_cli</code>.</p>"},{"location":"references/cli/","title":"CLI","text":""},{"location":"references/cli/#command-line-interface","title":"Command Line Interface","text":""},{"location":"references/cli/#pbi","title":"pbi","text":"<p>Usage:</p> <pre><code>pbi [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#apps","title":"apps","text":"<p>Power BI Apps Command Group</p> <p>Usage:</p> <pre><code>pbi apps [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#app","title":"app","text":"<p>Retrieve information about a specific Power BI App</p> <p>Usage:</p> <pre><code>pbi apps app [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -a, --app-id TEXT              app id  [required]\n  -t, --target PATH              target file  [required]\n  -ft, --file-type [json|excel]\n  --help                         Show this message and exit.\n</code></pre>"},{"location":"references/cli/#augment","title":"augment","text":"<p>Augment Power BI Apps data from a source file and save to target file</p> <p>Usage:</p> <pre><code>pbi apps augment [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -s, --source PATH              source file  [required]\n  -t, --target PATH              target file  [required]\n  -ft, --file-type [json|excel]\n  --help                         Show this message and exit.\n</code></pre>"},{"location":"references/cli/#list","title":"list","text":"<p>List Power BI Apps and save them to files</p> <p>Usage:</p> <pre><code>pbi apps list [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -tf, --target-folder PATH      target folder  [required]\n  -ft, --file-type [json|excel]\n  -r, --role [admin|user]\n  -n, --file-name TEXT           file name\n  --help                         Show this message and exit.\n</code></pre>"},{"location":"references/cli/#auth","title":"auth","text":"<p>Store authentication bearer token securely</p> <pre><code>pbi auth --bearer-token &lt;your_bearer_token&gt;\n</code></pre> <p>or with a custom profile name:</p> <pre><code>pbi auth -t &lt;your_bearer_token&gt; -p production\n</code></pre> <p>:param bearer_token: Bearer token to authenticate with Power BI API :param profile: Profile name to associate with this credential</p> <p>Usage:</p> <pre><code>pbi auth [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -t, --bearer-token TEXT  Bearer token  [required]\n  -p, --profile TEXT       Profile name for this credential set\n  --help                   Show this message and exit.\n</code></pre>"},{"location":"references/cli/#export","title":"export","text":"<p>export report based on id</p> <p>Usage:</p> <pre><code>pbi export [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -g, --group-id TEXT   Group ID  [required]\n  -r, --report-id TEXT  Report ID  [required]\n  -t, --target PATH     target file  [required]\n  --help                Show this message and exit.\n</code></pre>"},{"location":"references/cli/#profiles","title":"profiles","text":"<p>Manage authentication profiles</p> <p>Usage:</p> <pre><code>pbi profiles [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#delete","title":"delete","text":"<p>Delete an authentication profile</p> <pre><code>pbi profiles delete production\n</code></pre> <p>:param profile: Profile name to delete</p> <p>Usage:</p> <pre><code>pbi profiles delete [OPTIONS] PROFILE\n</code></pre> <p>Options:</p> <pre><code>  --yes   Confirm the action without prompting.\n  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#list_1","title":"list","text":"<p>List all stored authentication profiles</p> <pre><code>pbi list auth\n</code></pre> <p>Usage:</p> <pre><code>pbi profiles list [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#reports","title":"reports","text":"<p>Reports Command Group</p> <p>Usage:</p> <pre><code>pbi reports [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#export_1","title":"export","text":"<p>Export report as file</p> <p>Usage:</p> <pre><code>pbi reports export [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -g, --group-id TEXT   Group ID  [required]\n  -r, --report-id TEXT  Report ID  [required]\n  -t, --target PATH     target file  [required]\n  --help                Show this message and exit.\n</code></pre>"},{"location":"references/cli/#users","title":"users","text":"<p>Augment Power BI Apps data from a source file and save to target file together with report users</p> <p>Usage:</p> <pre><code>pbi reports users [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -s, --source PATH              source file  [required]\n  -t, --target PATH              target file  [required]\n  -ft, --file-type [json|excel]\n  --help                         Show this message and exit.\n</code></pre>"},{"location":"references/cli/#switch-profile","title":"switch-profile","text":"<p>Switch the active authentication profile</p> <pre><code>pbi switch-profile\n</code></pre> <p>or specify a profile:</p> <pre><code>pbi switch-profile production\n</code></pre> <p>:param profile_name: Profile name to switch to (optional, will show interactive selection if not provided)</p> <p>Usage:</p> <pre><code>pbi switch-profile [OPTIONS] [PROFILE_NAME]\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#users_1","title":"users","text":"<p>Command group for Power BI users</p> <p>Usage:</p> <pre><code>pbi users [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#user-access","title":"user-access","text":"<p>Get user access information from Power BI API</p> <p>Usage:</p> <pre><code>pbi users user-access [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -u, --user-id TEXT              user id  [required]\n  -tf, --target-folder PATH       target file\n  -ft, --file-types [json|excel]\n  -n, --file-name TEXT            file name without extension\n  --help                          Show this message and exit.\n</code></pre>"},{"location":"references/cli/#workspaces","title":"workspaces","text":"<p>Command group for Power BI workspaces</p> <p>Usage:</p> <pre><code>pbi workspaces [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --help  Show this message and exit.\n</code></pre>"},{"location":"references/cli/#format-convert","title":"format-convert","text":"<p>Convert output format of workspaces list (<code>pbi workspaces list</code>) from json to excel.</p> <pre><code>pbi workspaces format-convert -s \"workspaces.json\" -t \"workspaces.xlsx\"\n</code></pre> <p>Usage:</p> <pre><code>pbi workspaces format-convert [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -s, --source PATH  source file  [required]\n  -t, --target PATH  target file  [required]\n  --format [excel]   format of the file\n  --help             Show this message and exit.\n</code></pre>"},{"location":"references/cli/#list_2","title":"list","text":"<p>List Power BI workspaces and save them to files</p> <pre><code>pbi workspaces list -ft json -ft excel -tf \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\$(Get-Date -format 'yyyy-MM-dd')\" -e users -e reports -e dashboards -e datasets -e dataflows -e workbooks\n</code></pre> <p>Requires Admin</p> <p>This command requires an admin account.</p> <p>Usage:</p> <pre><code>pbi workspaces list [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  --top INTEGER                   top n results  [required]\n  -tf, --target-folder PATH       target folder  [required]\n  -e, --expand [users|reports|dashboards|datasets|dataflows|workbooks]\n  -f, --filter TEXT               odata filter\n  -ft, --file-type [json|excel]\n  -n, --file-name TEXT            file name\n  --help                          Show this message and exit.\n</code></pre>"},{"location":"references/cli/#report-users","title":"report-users","text":"<p>Augment Power BI Workspace data from a source file and save to target file together with report users</p> <p>The source <code>-s</code> should be the excel file exported from the command <code>pbi workspaces list</code></p> <pre><code>pbi workspaces report-users -s \"workspaces.xlsx\" -t \"$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n</code></pre> <p>Combined with PowerShell or bash, we can automatatically use different workspace names for the reports.</p> <p>Here is an example using PowerShell.</p> <pre><code>$workspaces = \"AA\", \"BB\"\nforeach ($w in $workspaces) {\n    Write-Host \"Backing up for: $w\"\n    pbi workspaces report-users -s \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\workspaces.xlsx\" --target-folder \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n}\n# Wait for 300 seconds (5 minutes) before the next loop\nStart-Sleep -Seconds 300\n</code></pre> <p>Usage:</p> <pre><code>pbi workspaces report-users [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -s, --source PATH              source json/excel file that contains all\n                                 workspace information  [required]\n  -t, --target-folder PATH       target folder to save the results to; Do not\n                                 include the trailing (back)slash  [required]\n  -ft, --file-type [json|excel]  file type to save the results as\n  -wi, --wait-interval INTEGER   number of seconds to wait between requests\n  -n, --file-name TEXT           file name without extension\n  -wn, --workspace-name TEXT     workspace names to download\n  --help                         Show this message and exit.\n</code></pre>"},{"location":"references/cli/#auxiliary-functions","title":"Auxiliary Functions","text":""},{"location":"references/cli/#pbi_cli.cli._check_keyring_availability","title":"<code>_check_keyring_availability()</code>","text":"<p>Check if keyring is available and working</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _check_keyring_availability():\n    \"\"\"Check if keyring is available and working\"\"\"\n    if not KEYRING_AVAILABLE:\n        return False\n    try:\n        # Test if we can use keyring\n        keyring.get_password(\"test-service\", \"test-user\")\n        return True\n    except NoKeyringError:\n        return False\n    except Exception:\n        # Any other exception means keyring might work\n        return True\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._delete_credential","title":"<code>_delete_credential(profile)</code>","text":"<p>Delete credential for a profile from keyring or file storage</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _delete_credential(profile: str):\n    \"\"\"Delete credential for a profile from keyring or file storage\"\"\"\n    if _check_keyring_availability():\n        try:\n            keyring.delete_password(KEYRING_SERVICE, profile)\n            return\n        except (NoKeyringError, PasswordDeleteError):\n            pass\n\n    # Fallback to file-based storage\n    if CREDENTIALS_FILE.exists():\n        with open(CREDENTIALS_FILE, \"r\") as fp:\n            credentials = json.load(fp)\n\n        if profile in credentials:\n            del credentials[profile]\n\n            with open(CREDENTIALS_FILE, \"w\") as fp:\n                json.dump(credentials, fp, indent=2)\n\n            CREDENTIALS_FILE.chmod(0o600)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._get_credential","title":"<code>_get_credential(profile)</code>","text":"<p>Get credential for a profile from keyring or file storage</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _get_credential(profile: str) -&gt; Optional[str]:\n    \"\"\"Get credential for a profile from keyring or file storage\"\"\"\n    if _check_keyring_availability():\n        try:\n            token = keyring.get_password(KEYRING_SERVICE, profile)\n            if token is not None:\n                return token\n        except NoKeyringError:\n            pass\n\n    # Fallback to file-based storage\n    if CREDENTIALS_FILE.exists():\n        with open(CREDENTIALS_FILE, \"r\") as fp:\n            credentials = json.load(fp)\n            return credentials.get(profile)\n\n    return None\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._load_profiles","title":"<code>_load_profiles()</code>","text":"<p>Load profiles configuration</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _load_profiles() -&gt; dict:\n    \"\"\"Load profiles configuration\"\"\"\n    _migrate_legacy_auth()\n\n    if not PROFILES_FILE.exists():\n        return {\"active_profile\": None, \"profiles\": {}}\n\n    with open(PROFILES_FILE, \"r\") as fp:\n        return json.load(fp)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._migrate_legacy_auth","title":"<code>_migrate_legacy_auth()</code>","text":"<p>Migrate legacy auth.json to the new profile-based system</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _migrate_legacy_auth():\n    \"\"\"Migrate legacy auth.json to the new profile-based system\"\"\"\n    if AUTH_CONFIG_FILE.exists() and not PROFILES_FILE.exists():\n        try:\n            with open(AUTH_CONFIG_FILE, \"r\") as fp:\n                legacy_auth = json.load(fp)\n\n            if \"Authorization\" in legacy_auth:\n                # Extract token from \"Bearer &lt;token&gt;\"\n                token = legacy_auth[\"Authorization\"].replace(\"Bearer \", \"\")\n                # Save to keyring or file\n                _set_credential(\"default\", token)\n                # Create profiles file\n                profiles_data = {\n                    \"active_profile\": \"default\",\n                    \"profiles\": {\"default\": {\"name\": \"default\"}},\n                }\n                with open(PROFILES_FILE, \"w\") as fp:\n                    json.dump(profiles_data, fp, indent=2)\n                logger.info(\n                    \"Migrated legacy auth to secure storage with profile 'default'\"\n                )\n        except Exception as e:\n            logger.warning(f\"Could not migrate legacy auth: {e}\")\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._save_profiles","title":"<code>_save_profiles(profiles_data)</code>","text":"<p>Save profiles configuration</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _save_profiles(profiles_data: dict):\n    \"\"\"Save profiles configuration\"\"\"\n    if not CONFIG_DIR.exists():\n        CONFIG_DIR.mkdir(parents=True, exist_ok=True)\n\n    with open(PROFILES_FILE, \"w\") as fp:\n        json.dump(profiles_data, fp, indent=2)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli._set_credential","title":"<code>_set_credential(profile, token)</code>","text":"<p>Set credential for a profile using keyring or fallback to file storage</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def _set_credential(profile: str, token: str):\n    \"\"\"Set credential for a profile using keyring or fallback to file storage\"\"\"\n    if _check_keyring_availability():\n        try:\n            keyring.set_password(KEYRING_SERVICE, profile, token)\n            return\n        except NoKeyringError:\n            pass\n\n    # Fallback to file-based storage\n    logger.warning(\n        \"Keyring not available, storing credentials in file. \"\n        \"For better security, install a keyring backend (e.g., pip install keyrings.alt)\"\n    )\n\n    if not CONFIG_DIR.exists():\n        CONFIG_DIR.mkdir(parents=True, exist_ok=True)\n\n    credentials = {}\n    if CREDENTIALS_FILE.exists():\n        with open(CREDENTIALS_FILE, \"r\") as fp:\n            credentials = json.load(fp)\n\n    credentials[profile] = token\n\n    with open(CREDENTIALS_FILE, \"w\") as fp:\n        json.dump(credentials, fp, indent=2)\n\n    # Set restrictive permissions on the credentials file\n    CREDENTIALS_FILE.chmod(0o600)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.app","title":"<code>app(app_id, target, file_type='json')</code>","text":"<p>Retrieve information about a specific Power BI App</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@apps.command()\n@click.option(\"--app-id\", \"-a\", help=\"app id\", type=str, required=True)\n@click.option(\n    \"--target\", \"-t\", type=click.Path(exists=False), help=\"target file\", required=True\n)\n@click.option(\n    \"--file-type\", \"-ft\", type=click.Choice([\"json\", \"excel\"]), default=\"json\"\n)\ndef app(app_id: str, target: Path, file_type: str = \"json\"):\n    \"\"\"Retrieve information about a specific Power BI App\"\"\"\n    click.echo(f\"Investigating {app_id}\")\n\n    a_app = powerbi_app.App(auth=load_auth(), verify=False, app_id=app_id)\n    app_data = a_app()\n\n    if file_type == \"json\":\n        with open(target, \"w\") as fp:\n            json.dump(app_data, fp)\n    elif file_type == \"excel\":\n        app_data_flattened = a_app.flatten_app(app_data)\n        multi_group_dict_to_excel(app_data_flattened, target)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.apps","title":"<code>apps(ctx)</code>","text":"<p>Power BI Apps Command Group</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.group(invoke_without_command=True)\n@click.pass_context\ndef apps(ctx):\n    \"\"\"Power BI Apps Command Group\"\"\"\n    if ctx.invoked_subcommand is None:\n        click.echo(\"Use pbi apps --help.\")\n    else:\n        pass\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.augment","title":"<code>augment(source, target, file_type='json')</code>","text":"<p>Augment Power BI Apps data from a source file and save to target file</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@apps.command()\n@click.option(\n    \"--source\",\n    \"-s\",\n    type=click.Path(exists=True, path_type=Path),\n    help=\"source file\",\n    required=True,\n)\n@click.option(\n    \"--target\",\n    \"-t\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target file\",\n    required=True,\n)\n@click.option(\n    \"--file-type\", \"-ft\", type=click.Choice([\"json\", \"excel\"]), default=\"json\"\n)\ndef augment(source: Path, target: Path, file_type: str = \"json\"):\n    \"\"\"Augment Power BI Apps data from a source file and save to target file\"\"\"\n    if file_type == \"excel\":\n        if target.suffix:\n            click.echo(\"Use path as target for excel output\")\n            raise click.BadOptionUsage(message=f\"{target=}\")\n        else:\n            click.secho(f\"creating folder {target}\", fg=\"blue\")\n            target.mkdir(parents=True, exist_ok=True)\n\n    pbi_apps = powerbi_app.Apps(auth=load_auth(), verify=False, cache_file=source)\n\n    apps_data = []\n    for a in pbi_apps.apps:\n        try:\n            apps_data.append(a())\n        except ValueError as e:\n            click.secho(f\"Cannot download {a.app_info}\", fg=\"red\")\n\n    if file_type == \"json\":\n        with open(target, \"w\") as fp:\n            json.dump(apps_data, fp)\n    elif file_type == \"excel\":\n        for a_data in apps_data:\n            a_id = a_data.get(\"id\")\n            a_name = a_data.get(\"name\")\n            a_data_flattened = pbi_apps.apps[0].flatten_app(a_data)\n            multi_group_dict_to_excel(\n                a_data_flattened, target / f\"{a_name}_{a_id}.xlsx\"\n            )\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.auth","title":"<code>auth(bearer_token, profile)</code>","text":"<p>Store authentication bearer token securely</p> <pre><code>pbi auth --bearer-token &lt;your_bearer_token&gt;\n</code></pre> <p>or with a custom profile name:</p> <pre><code>pbi auth -t &lt;your_bearer_token&gt; -p production\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>bearer_token</code> <code>str</code> <p>Bearer token to authenticate with Power BI API</p> required <code>profile</code> <code>str</code> <p>Profile name to associate with this credential</p> required Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.command()\n@click.option(\"--bearer-token\", \"-t\", help=\"Bearer token\", required=True)\n@click.option(\n    \"--profile\",\n    \"-p\",\n    help=\"Profile name for this credential set\",\n    default=\"default\",\n)\ndef auth(bearer_token: str, profile: str):\n    \"\"\"Store authentication bearer token securely\n\n    ```\n    pbi auth --bearer-token &lt;your_bearer_token&gt;\n    ```\n\n    or with a custom profile name:\n\n    ```\n    pbi auth -t &lt;your_bearer_token&gt; -p production\n    ```\n\n    :param bearer_token: Bearer token to authenticate with Power BI API\n    :param profile: Profile name to associate with this credential\n    \"\"\"\n\n    if bearer_token.startswith(\"Bearer\"):\n        logger.warning(\"Do not include the Bearer string in the beginning\")\n        bearer_token = bearer_token.replace(\"Bearer \", \"\")\n\n    if not CONFIG_DIR.exists():\n        logger.info(f\"Creating config folder: {CONFIG_DIR}\")\n        CONFIG_DIR.mkdir(parents=True, exist_ok=True)\n\n    # Store token securely\n    _set_credential(profile, bearer_token)\n\n    # Update profiles configuration\n    profiles_data = _load_profiles()\n    if \"profiles\" not in profiles_data:\n        profiles_data[\"profiles\"] = {}\n\n    profiles_data[\"profiles\"][profile] = {\"name\": profile}\n\n    # Set as active profile if it's the first one or if it's 'default'\n    if not profiles_data.get(\"active_profile\") or profile == \"default\":\n        profiles_data[\"active_profile\"] = profile\n\n    _save_profiles(profiles_data)\n\n    click.secho(f\"\u2713 Credentials saved securely for profile '{profile}'\", fg=\"green\")\n    if profiles_data[\"active_profile\"] == profile:\n        click.secho(f\"\u2713 Profile '{profile}' is now active\", fg=\"green\")\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.delete_auth","title":"<code>delete_auth(profile)</code>","text":"<p>Delete an authentication profile</p> <pre><code>pbi profiles delete production\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>profile</code> <code>str</code> <p>Profile name to delete</p> required Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@profiles_group.command(name=\"delete\")\n@click.argument(\"profile\")\n@click.confirmation_option(prompt=\"Are you sure you want to delete this profile?\")\ndef delete_auth(profile: str):\n    \"\"\"Delete an authentication profile\n\n    ```\n    pbi profiles delete production\n    ```\n\n    :param profile: Profile name to delete\n    \"\"\"\n    profiles_data = _load_profiles()\n\n    if profile not in profiles_data.get(\"profiles\", {}):\n        click.secho(\n            f\"Profile '{profile}' not found. Use 'pbi list auth' to see available profiles.\",\n            fg=\"red\",\n        )\n        return\n\n    # Delete credential\n    _delete_credential(profile)\n\n    # Remove from profiles\n    del profiles_data[\"profiles\"][profile]\n\n    # If this was the active profile, clear it or switch to another\n    if profiles_data.get(\"active_profile\") == profile:\n        # Use tuple() instead of list() to avoid shadowing by the workspaces list command\n        remaining_profiles = tuple(profiles_data[\"profiles\"].keys())\n        profiles_data[\"active_profile\"] = (\n            remaining_profiles[0] if remaining_profiles else None\n        )\n\n    _save_profiles(profiles_data)\n\n    click.secho(f\"\u2713 Profile '{profile}' deleted successfully\", fg=\"green\")\n    if profiles_data.get(\"active_profile\"):\n        click.secho(\n            f\"Active profile is now '{profiles_data['active_profile']}'\", fg=\"yellow\"\n        )\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.export","title":"<code>export(group_id, report_id, target)</code>","text":"<p>Export report as file</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@reports.command()\n@click.option(\"--group-id\", \"-g\", help=\"Group ID\", required=True)\n@click.option(\"--report-id\", \"-r\", help=\"Report ID\", required=True)\n@click.option(\n    \"--target\",\n    \"-t\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target file\",\n    required=True,\n)\ndef export(group_id: str, report_id: str, target: Path):\n    \"\"\"Export report as file\"\"\"\n\n    pbi_report = powerbi_report.Report(\n        auth=load_auth(), verify=False, report_id=report_id, group_id=group_id\n    )\n\n    result = pbi_report.export()\n    # click.echo(result)\n\n    with open(target, \"wb\") as fp:\n        fp.write(result)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.format_convert","title":"<code>format_convert(source, target, format)</code>","text":"<p>Convert output format of workspaces list (<code>pbi workspaces list</code>) from json to excel.</p> <pre><code>pbi workspaces format-convert -s \"workspaces.json\" -t \"workspaces.xlsx\"\n</code></pre> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@workspaces.command()\n@click.option(\n    \"--source\",\n    \"-s\",\n    type=click.Path(exists=True, path_type=Path),\n    help=\"source file\",\n    required=True,\n)\n@click.option(\n    \"--target\",\n    \"-t\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target file\",\n    required=True,\n)\n@click.option(\n    \"--format\",\n    type=click.Choice([\"excel\"]),\n    help=\"format of the file\",\n    default=\"excel\",\n    required=False,\n)\ndef format_convert(source: Path, target: Path, format):\n    \"\"\"Convert output format of workspaces list\n    (`pbi workspaces list`)\n    from json to excel.\n\n    ```sh\n    pbi workspaces format-convert -s \"workspaces.json\" -t \"workspaces.xlsx\"\n    ```\n    \"\"\"\n    workspaces = Workspaces(auth={}, verify=False)\n\n    click.echo(f\"Converting to {format=}: {source=} -&gt; {target}\")\n\n    with open(source, \"r\") as fp:\n        workspaces_data = json.load(fp)\n\n    flattened = workspaces.flatten_workspaces(workspaces_data[\"value\"])\n\n    multi_group_dict_to_excel(flattened, target)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.list","title":"<code>list(target_folder, role, file_type=('json', 'excel'), file_name='apps')</code>","text":"<p>List Power BI Apps and save them to files</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@apps.command()\n@click.option(\n    \"--target-folder\",\n    \"-tf\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target folder\",\n    required=True,\n)\n@click.option(\n    \"--file-type\",\n    \"-ft\",\n    type=click.Choice([\"json\", \"excel\"]),\n    default=[\"json\"],\n    multiple=True,\n)\n@click.option(\"--role\", \"-r\", type=click.Choice([\"admin\", \"user\"]), default=\"user\")\n@click.option(\"--file-name\", \"-n\", type=str, help=\"file name\", default=\"apps\")\ndef list(\n    target_folder: Path,\n    role: str,\n    file_type: tuple = (\"json\", \"excel\"),\n    file_name: str = \"apps\",\n):\n    \"\"\"List Power BI Apps and save them to files\"\"\"\n    if not target_folder.exists():\n        click.secho(f\"creating folder {target_folder}\", fg=\"blue\")\n        target_folder.mkdir(parents=True, exist_ok=True)\n\n    if role == \"user\":\n        user = powerbi_app.Apps(auth=load_auth(), verify=False)\n    elif role == \"admin\":\n        user = powerbi_admin.Apps(auth=load_auth(), verify=False)\n\n    click.echo(f\"Listing Apps as {role}\")\n\n    result = user()\n\n    if \"json\" in file_type:\n        json_file_path = target_folder / f\"{file_name}.json\"\n        logger.info(f\"Writing json file to {json_file_path}\")\n        with open(json_file_path, \"w\") as fp:\n            json.dump(result, fp)\n\n    if \"excel\" in file_type:\n        excel_file_path = target_folder / f\"{file_name}.xlsx\"\n        logger.info(f\"Writing excel file to {excel_file_path}\")\n        df = pd.json_normalize(result[\"value\"])\n        df.to_excel(excel_file_path)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.list_auth","title":"<code>list_auth()</code>","text":"<p>List all stored authentication profiles</p> <pre><code>pbi list auth\n</code></pre> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@profiles_group.command(name=\"list\")\ndef list_auth():\n    \"\"\"List all stored authentication profiles\n\n    ```\n    pbi list auth\n    ```\n    \"\"\"\n    profiles_data = _load_profiles()\n    profiles = profiles_data.get(\"profiles\", {})\n    active_profile = profiles_data.get(\"active_profile\")\n\n    if not profiles:\n        click.secho(\n            \"No profiles found. Use 'pbi auth' to create a profile.\", fg=\"yellow\"\n        )\n        return\n\n    click.echo(\"Stored authentication profiles:\")\n    for profile_name in profiles.keys():\n        active_marker = \" (active)\" if profile_name == active_profile else \"\"\n        # Check if token exists\n        token_exists = _get_credential(profile_name) is not None\n        status = \"\u2713\" if token_exists else \"\u2717\"\n        click.echo(f\"  {status} {profile_name}{active_marker}\")\n\n    click.echo()\n    click.echo(f\"Active profile: {active_profile or 'None'}\")\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.load_auth","title":"<code>load_auth(profile=None)</code>","text":"<p>Load authentication for the specified profile or active profile</p> <p>Parameters:</p> Name Type Description Default <code>profile</code> <code>Optional[str]</code> <p>Profile name. If None, uses the active profile.</p> <code>None</code> <p>Returns:</p> Type Description <code>dict</code> <p>dict containing {\"Authorization\": \"Bearer \"} Source code in <code>src/pbi_cli/cli.py</code> <pre><code>def load_auth(profile: Optional[str] = None) -&gt; dict:\n    \"\"\"Load authentication for the specified profile or active profile\n\n    :param profile: Profile name. If None, uses the active profile.\n    :return: dict containing {\"Authorization\": \"Bearer &lt;token&gt;\"}\n    \"\"\"\n    profiles_data = _load_profiles()\n\n    if profile is None:\n        profile = profiles_data.get(\"active_profile\")\n\n    if profile is None:\n        raise click.ClickException(\n            \"No active profile set. Use 'pbi auth' to create a profile or 'pbi switch-profile' to switch profiles.\"\n        )\n\n    if profile not in profiles_data.get(\"profiles\", {}):\n        raise click.ClickException(\n            f\"Profile '{profile}' not found. Use 'pbi profiles list' to see available profiles.\"\n        )\n\n    # Get token from keyring or file\n    token = _get_credential(profile)\n    if token is None:\n        raise click.ClickException(\n            f\"No credentials found for profile '{profile}'. Please re-authenticate.\"\n        )\n\n    return {\"Authorization\": f\"Bearer {token}\"}\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.profiles_group","title":"<code>profiles_group(ctx)</code>","text":"<p>Manage authentication profiles</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.group(name=\"profiles\", invoke_without_command=True)\n@click.pass_context\ndef profiles_group(ctx):\n    \"\"\"Manage authentication profiles\"\"\"\n    if ctx.invoked_subcommand is None:\n        click.echo(\"Use pbi profiles --help for help.\")\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.report_users","title":"<code>report_users(source, target_folder, file_type=['json', 'excel'], wait_interval=3, file_name='workspaces_reports_users', workspace_name=None)</code>","text":"<p>Augment Power BI Workspace data from a source file and save to target file together with report users</p> <p>The source <code>-s</code> should be the excel file exported from the command <code>pbi workspaces list</code></p> <pre><code>pbi workspaces report-users -s \"workspaces.xlsx\" -t \"$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n</code></pre> <p>Combined with PowerShell or bash, we can automatatically use different workspace names for the reports.</p> <p>Here is an example using PowerShell.</p> <pre><code>$workspaces = \"AA\", \"BB\"\nforeach ($w in $workspaces) {\n    Write-Host \"Backing up for: $w\"\n    pbi workspaces report-users -s \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\workspaces.xlsx\" --target-folder \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n}\n# Wait for 300 seconds (5 minutes) before the next loop\nStart-Sleep -Seconds 300\n</code></pre> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@workspaces.command()\n@click.option(\n    \"--source\",\n    \"-s\",\n    type=click.Path(exists=True, path_type=Path),\n    help=\"source json/excel file that contains all workspace information\",\n    required=True,\n)\n@click.option(\n    \"--target-folder\",\n    \"-t\",\n    type=click.Path(path_type=Path),\n    help=(\n        \"target folder to save the results to; \"\n        \"Do not include the trailing (back)slash\"\n    ),\n    required=True,\n)\n@click.option(\n    \"--file-type\",\n    \"-ft\",\n    help=\"file type to save the results as\",\n    type=click.Choice([\"json\", \"excel\"]),\n    default=[\"json\", \"excel\"],\n    multiple=True,\n)\n@click.option(\n    \"--wait-interval\",\n    \"-wi\",\n    help=\"number of seconds to wait between requests\",\n    type=int,\n    default=3,\n)\n@click.option(\n    \"--file-name\",\n    \"-n\",\n    type=str,\n    help=\"file name without extension\",\n    default=\"workspaces_reports_users\",\n)\n@click.option(\n    \"--workspace-name\",\n    \"-wn\",\n    help=\"workspace names to download\",\n    type=str,\n    default=None,\n    multiple=True,\n    required=False,\n)\ndef report_users(\n    source: Path,\n    target_folder: Path,\n    file_type: list = [\"json\", \"excel\"],\n    wait_interval: int = 3,\n    file_name: str = \"workspaces_reports_users\",\n    workspace_name: Optional[list] = None,\n):\n    r\"\"\"\n    Augment Power BI Workspace data from a source file\n    and save to target file together with report users\n\n    The source `-s` should be the excel file exported from the command\n    `pbi workspaces list`\n\n    ```sh\n    pbi workspaces report-users -s \"workspaces.xlsx\" -t \"$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n    ```\n\n    Combined with PowerShell or bash, we can automatatically\n    use different workspace names for the reports.\n\n    Here is an example using PowerShell.\n\n    ```powershell\n    $workspaces = \"AA\", \"BB\"\n    foreach ($w in $workspaces) {\n        Write-Host \"Backing up for: $w\"\n        pbi workspaces report-users -s \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\workspaces.xlsx\" --target-folder \"C:\\Users\\$Env:UserName\\PowerBI\\backups\\$(Get-Date -format 'yyyy-MM-dd')\" -wn $w -n $w -wi 5\n    }\n    # Wait for 300 seconds (5 minutes) before the next loop\n    Start-Sleep -Seconds 300\n    ```\n    \"\"\"\n    click.secho(\"getting report user details requires admin token\")\n\n    # if not target_folder.is_dir():\n    #     click.echo(\"Please specify a folder instead for excel output\")\n    #     raise click.BadOptionUsage(option_name=\"target-folder\", message=f\"{target_folder=}\")\n    if not target_folder.exists():\n        click.secho(f\"creating folder {target_folder}\", fg=\"blue\")\n        target_folder.mkdir(parents=True, exist_ok=True)\n\n    pbi_workspaces = powerbi_workspace.Workspaces(\n        auth=load_auth(), verify=False, cache_file=source\n    )\n\n    report_users = pbi_workspaces.report_users(\n        workspace_types=[\"Workspace\"],\n        workspace_name=workspace_name,\n        wait_interval=wait_interval,\n    )\n\n    click.secho(f\"Writing results to the folder {target_folder}\")\n    if \"json\" in file_type:\n        json_file_path = target_folder / f\"{file_name}.json\"\n        logger.info(f\"Writing json file to {json_file_path}...\")\n        with open(json_file_path, \"w\") as fp:\n            json.dump(report_users, fp)\n    if \"excel\" in file_type:\n        excel_file_path = target_folder / f\"{file_name}.xlsx\"\n        logger.info(f\"Writing excel file to {excel_file_path}...\")\n\n        multi_group_dict_to_excel(\n            pbi_workspaces.flatten_workspaces_reports_users(report_users),\n            excel_file_path,\n        )\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.reports","title":"<code>reports(ctx)</code>","text":"<p>Reports Command Group</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.group(invoke_without_command=True)\n@click.pass_context\ndef reports(ctx):\n    \"\"\"Reports Command Group\"\"\"\n    if ctx.invoked_subcommand is None:\n        click.echo(\"Use pbi reports --help.\")\n    else:\n        pass\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.switch_profile_cmd","title":"<code>switch_profile_cmd(profile_name=None)</code>","text":"<p>Switch the active authentication profile</p> <pre><code>pbi switch-profile\n</code></pre> <p>or specify a profile:</p> <pre><code>pbi switch-profile production\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>profile_name</code> <code>Optional[str]</code> <p>Profile name to switch to (optional, will show interactive selection if not provided)</p> <code>None</code> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.command(name=\"switch-profile\")\n@click.argument(\"profile_name\", required=False)\ndef switch_profile_cmd(profile_name: Optional[str] = None):\n    \"\"\"Switch the active authentication profile\n\n    ```\n    pbi switch-profile\n    ```\n\n    or specify a profile:\n\n    ```\n    pbi switch-profile production\n    ```\n\n    :param profile_name: Profile name to switch to (optional, will show interactive selection if not provided)\n    \"\"\"\n    profiles_data = _load_profiles()\n    # Use tuple() instead of list() to avoid shadowing by the workspaces list command\n    available_profiles = tuple(profiles_data.get(\"profiles\", {}).keys())\n\n    if not available_profiles:\n        click.secho(\n            \"No profiles found. Use 'pbi auth' to create a profile.\", fg=\"yellow\"\n        )\n        return\n\n    # If no profile specified, show interactive selection\n    if profile_name is None:\n        click.echo(\"Available profiles:\")\n        for idx, prof in enumerate(available_profiles, 1):\n            active_marker = (\n                \" (active)\" if prof == profiles_data.get(\"active_profile\") else \"\"\n            )\n            click.echo(f\"  {idx}. {prof}{active_marker}\")\n\n        choice = click.prompt(\n            \"Select profile number\", type=int, default=1, show_default=True\n        )\n        if 1 &lt;= choice &lt;= len(available_profiles):\n            profile_name = available_profiles[choice - 1]\n        else:\n            click.secho(\"Invalid selection\", fg=\"red\")\n            return\n\n    if profile_name not in available_profiles:\n        click.secho(\n            f\"Profile '{profile_name}' not found. Use 'pbi profiles list' to see available profiles.\",\n            fg=\"red\",\n        )\n        return\n\n    profiles_data[\"active_profile\"] = profile_name\n    _save_profiles(profiles_data)\n\n    click.secho(f\"\u2713 Switched to profile '{profile_name}'\", fg=\"green\")\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.user_access","title":"<code>user_access(user_id, target_folder, file_types, file_name=None)</code>","text":"<p>Get user access information from Power BI API</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@users.command()\n@click.option(\"--user-id\", \"-u\", help=\"user id\", type=str, required=True)\n@click.option(\n    \"--target-folder\",\n    \"-tf\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target file\",\n    required=False,\n)\n@click.option(\n    \"--file-types\",\n    \"-ft\",\n    type=click.Choice([\"json\", \"excel\"]),\n    multiple=True,\n    default=[\"json\"],\n    required=False,\n)\n@click.option(\n    \"--file-name\", \"-n\", type=str, help=\"file name without extension\", default=None\n)\ndef user_access(\n    user_id: str,\n    target_folder: Optional[Path],\n    file_types: list,\n    file_name: Optional[str] = None,\n):\n    \"\"\"Get user access information from Power BI API\"\"\"\n    if file_name is None:\n        file_name = slugify(user_id)\n\n    user = User(auth=load_auth(), user_id=user_id, verify=False)\n\n    result = user()\n\n    if target_folder is None:\n        logger.info(f\"No target folder provided, printing to interface...\")\n        click.echo(json.dumps(result, indent=4))\n    else:\n        if not target_folder.exists():\n            click.secho(f\"creating folder {target_folder}\", fg=\"blue\")\n            target_folder.mkdir(parents=True, exist_ok=True)\n\n        if \"json\" in file_types:\n            json_file_path = target_folder / f\"{file_name}.json\"\n            logger.info(f\"Writing json file to {json_file_path}...\")\n            with open(json_file_path, \"w\") as fp:\n                json.dump(result, fp)\n        if \"excel\" in file_types:\n            excel_file_path = target_folder / f\"{file_name}.xlsx\"\n            logger.info(f\"Writing excel file to {excel_file_path}...\")\n            df = pd.json_normalize(result)\n            df.to_excel(excel_file_path)\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.users","title":"<code>users(source, target, file_type='json')</code>","text":"<p>Augment Power BI Apps data from a source file and save to target file together with report users</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@reports.command()\n@click.option(\n    \"--source\",\n    \"-s\",\n    type=click.Path(exists=True, path_type=Path),\n    help=\"source file\",\n    required=True,\n)\n@click.option(\n    \"--target\",\n    \"-t\",\n    type=click.Path(exists=False, path_type=Path),\n    help=\"target file\",\n    required=True,\n)\n@click.option(\n    \"--file-type\", \"-ft\", type=click.Choice([\"json\", \"excel\"]), default=\"json\"\n)\ndef users(source: Path, target: Path, file_type: str = \"json\"):\n    \"\"\"Augment Power BI Apps data from a source file and save to target file together with report users\"\"\"\n\n    click.secho(\"getting report user details requires admin token\")\n\n    if file_type == \"excel\":\n        if target.suffix:\n            click.echo(\"Use path as target for excel output\")\n            raise click.BadOptionUsage(message=f\"{target=}\")\n        else:\n            click.secho(f\"creating folder {target}\", fg=\"blue\")\n            target.mkdir(parents=True, exist_ok=True)\n\n    pbi_apps = powerbi_app.Apps(auth=load_auth(), verify=False, cache_file=source)\n\n    apps_data = []\n    for a in pbi_apps.apps:\n        try:\n            apps_data.append(a())\n        except ValueError as e:\n            click.secho(f\"Can not download {a.app_info}\", fg=\"red\")\n\n    updated_apps_data = []\n    for a in apps_data:\n        report_data = []\n        failed_id = []\n        for r in a.get(\"reports\", []):\n            report_id = r.get(\"id\")\n            try:\n                logger.debug(f\"Retrieving user info for {r['name']}, {report_id}\")\n                r_data = powerbi_admin_report.ReportUsers(\n                    auth=load_auth(), report_id=report_id, verify=False\n                ).users\n                r_data = {**r_data, **r}\n                report_data.append(r_data)\n            except ValueError as e:\n                failed_id.append(report_id)\n                logger.warning(f\"Failed to download {r['name']}, {report_id}\\n{e}\")\n        a[\"reports\"] = report_data\n        updated_apps_data.append(a)\n\n    if file_type == \"json\":\n        with open(target, \"w\") as fp:\n            json.dump(updated_apps_data, fp)\n    elif file_type == \"excel\":\n        for a_data in updated_apps_data:\n            a_id = a_data.get(\"id\")\n            a_name = a_data.get(\"name\")\n            a_data_flattened = pbi_apps.apps[0].flatten_app(a_data)\n            multi_group_dict_to_excel(\n                a_data_flattened, target / f\"{a_name}_{a_id}_report_users.xlsx\"\n            )\n</code></pre>"},{"location":"references/cli/#pbi_cli.cli.workspaces","title":"<code>workspaces(ctx)</code>","text":"<p>Command group for Power BI workspaces</p> Source code in <code>src/pbi_cli/cli.py</code> <pre><code>@pbi.group(invoke_without_command=True)\n@click.pass_context\ndef workspaces(ctx):\n    \"\"\"Command group for Power BI workspaces\"\"\"\n    if ctx.invoked_subcommand is None:\n        click.echo(\"Use pbi workspaces --help for help.\")\n    else:\n        pass\n</code></pre>"},{"location":"references/powerbi/","title":"<code>pbi_cli.powerbi</code>","text":"<p><code>pbi_cli.powerbi</code> is the module that deals with the Power BI API.</p>"},{"location":"references/powerbi/admin/","title":"<code>pbi_cli.powerbi.admin</code>","text":""},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.Apps","title":"<code>Apps</code>","text":"<p>               Bases: <code>Base</code></p> <p>A class to interact with Power BI Apps using the Base class.</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify SSL</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/admin/__init__.py</code> <pre><code>class Apps(Base):\n    \"\"\"\n    A class to interact with Power BI Apps using the Base class.\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify SSL\n    \"\"\"\n\n    def __init__(self, auth: dict, verify: bool = True):\n        super().__init__(auth=auth, verify=verify)\n\n    @property\n    def _base_uri(self) -&gt; str:\n        \"\"\"\n        Returns the base URI for Power BI Apps API.\n        \"\"\"\n        return \"https://api.powerbi.com/v1.0/myorg/admin/apps\"\n\n    def __call__(\n        self,\n        top: int = 200,\n        format: Literal[\"raw\", \"flatten\"] = \"raw\",\n    ):\n        query_params = {\"top\": top}\n\n        query_params_encoded = self._encode_query_params(query_params)\n        uri = f\"{self._base_uri}?{query_params_encoded}\"\n        result = self._data_retriever.get(uri).json()\n\n        if result.get(\"error\"):\n            raise ValueError(f\"Error: {result}\")\n\n        logger.info(f\"Listing {len(result.get('value', []))} results\")\n\n        if format == \"raw\":\n            return result\n        elif format == \"flatten\":\n            return result[\"value\"]\n</code></pre>"},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.Apps._base_uri","title":"<code>_base_uri</code>  <code>property</code>","text":"<p>Returns the base URI for Power BI Apps API.</p>"},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.User","title":"<code>User</code>","text":"<p>Accessing user info</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify ssl</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/admin/__init__.py</code> <pre><code>class User:\n    \"\"\"Accessing user info\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify ssl\n    \"\"\"\n\n    def __init__(self, auth: dict, user_id: str, verify: bool = True):\n        self.auth = auth\n        self.verify = verify\n        self.user_id = user_id\n\n    @property\n    def _data_retriever(self):\n        return DataRetriever(\n            session_query_configs={\"headers\": self.auth, \"verify\": self.verify}\n        )\n\n    @property\n    def _base_uri(self) -&gt; str:\n        return \"https://api.powerbi.com/v1.0/myorg/admin/users/{userId}/artifactAccess\"\n\n    def _get_user_artifacts(\n        self,\n        user_id: str,\n        continueation_uri: Optional[str] = None,\n        existing_data: Optional[list] = [],\n    ) -&gt; list[dict]:\n        \"\"\"downloading user artifacts access\n\n        :param user_id: user id\n        :param continueation_uri: continuation uri from the API return\n        :param existing_data: existing data to append to\n        \"\"\"\n        uri = self._base_uri.format(userId=user_id)\n\n        if continueation_uri is None:\n            current_page = self._data_retriever.get(uri).json()\n        else:\n            logger.info(f\"Using continuation uri: {continueation_uri}\")\n            current_page = self._data_retriever.get(continueation_uri).json()\n\n        if current_page.get(\"error\"):\n            raise ValueError(f\"Error: {current_page}\")\n\n        current_data = current_page.get(\"ArtifactAccessEntities\", [])\n        logger.info(f\"Downloaded {len(current_data)} results\")\n\n        existing_data.extend(current_data)\n\n        return existing_data\n\n    @cached_property\n    def user_artifacts(self) -&gt; list[dict]:\n        return self._get_user_artifacts(user_id=self.user_id)\n\n    def __call__(self) -&gt; dict:\n\n        return {\n            \"artifacts\": self.user_artifacts,\n        }\n</code></pre>"},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.User._get_user_artifacts","title":"<code>_get_user_artifacts(user_id, continueation_uri=None, existing_data=[])</code>","text":"<p>downloading user artifacts access</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>str</code> <p>user id</p> required <code>continueation_uri</code> <code>Optional[str]</code> <p>continuation uri from the API return</p> <code>None</code> <code>existing_data</code> <code>Optional[list]</code> <p>existing data to append to</p> <code>[]</code> Source code in <code>src/pbi_cli/powerbi/admin/__init__.py</code> <pre><code>def _get_user_artifacts(\n    self,\n    user_id: str,\n    continueation_uri: Optional[str] = None,\n    existing_data: Optional[list] = [],\n) -&gt; list[dict]:\n    \"\"\"downloading user artifacts access\n\n    :param user_id: user id\n    :param continueation_uri: continuation uri from the API return\n    :param existing_data: existing data to append to\n    \"\"\"\n    uri = self._base_uri.format(userId=user_id)\n\n    if continueation_uri is None:\n        current_page = self._data_retriever.get(uri).json()\n    else:\n        logger.info(f\"Using continuation uri: {continueation_uri}\")\n        current_page = self._data_retriever.get(continueation_uri).json()\n\n    if current_page.get(\"error\"):\n        raise ValueError(f\"Error: {current_page}\")\n\n    current_data = current_page.get(\"ArtifactAccessEntities\", [])\n    logger.info(f\"Downloaded {len(current_data)} results\")\n\n    existing_data.extend(current_data)\n\n    return existing_data\n</code></pre>"},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.Workspaces","title":"<code>Workspaces</code>","text":"<p>Accessing all workspaces</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify ssl</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/admin/__init__.py</code> <pre><code>class Workspaces:\n    \"\"\"Accessing all workspaces\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify ssl\n    \"\"\"\n\n    def __init__(self, auth: dict, verify: bool = True):\n        self.auth = auth\n        self.verify = verify\n\n    @property\n    def _data_retriever(self):\n        return DataRetriever(\n            session_query_configs={\"headers\": self.auth, \"verify\": self.verify}\n        )\n\n    @property\n    def _base_uri(self) -&gt; str:\n        return \"https://api.powerbi.com/v1.0/myorg/admin/groups\"\n\n    @staticmethod\n    def _flatten_workspace(data_workspace: dict) -&gt; dict:\n\n        workspace_level_keys = [\n            k\n            for k, v in data_workspace.items()\n            if not isinstance(data_workspace.get(k), list)\n        ]\n        keys = [\"users\", \"reports\", \"dashboards\", \"datasets\", \"dataflows\", \"workbooks\"]\n\n        flattened = {}\n\n        for key in keys:\n            flattened[key] = [\n                {\n                    **{\n                        k: v\n                        for k, v in data_workspace.items()\n                        if k in workspace_level_keys\n                    },\n                    **{f\"{key}_{d_k}\": d[d_k] for d_k in d},\n                }\n                for d in data_workspace.get(key, [])\n            ]\n\n        flattened[\"workspace\"] = [\n            {k: v for k, v in data_workspace.items() if k in workspace_level_keys}\n        ]\n\n        return flattened\n\n    def flatten_workspaces(self, data_all_workspaces: list[dict]):\n        all_workspaces = []\n        for w in data_all_workspaces:\n            all_workspaces.append(self._flatten_workspace(w))\n\n        all_workspaces = {\n            k: sum([w.get(k, []) for w in all_workspaces], [])\n            for k in all_workspaces[0]\n        }\n\n        return all_workspaces\n\n    def __call__(\n        self,\n        top: int = 1000,\n        expand: Optional[\n            List[\n                Literal[\n                    \"users\",\n                    \"reports\",\n                    \"dashboards\",\n                    \"datasets\",\n                    \"dataflows\",\n                    \"workbooks\",\n                ]\n            ]\n        ] = None,\n        filter: Optional[str] = None,\n        format: Literal[\"raw\", \"flatten\"] = \"raw\",\n    ):\n        \"\"\"\n\n        See https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-groups-as-admin\n\n        :param top: top n results\n        :param expand: see official docs\n        :param filter: odata filter, see official docs\n        \"\"\"\n        query_params = {\"top\": top}\n\n        if (\n            (expand is not None)\n            and isinstance(expand, (list, tuple))\n            and len(expand) &gt;= 1\n        ):\n            query_params[\"expand\"] = \",\".join(expand)\n\n        if filter is not None:\n            query_params[\"filter\"] = filter\n\n        query_params_encoded = \"&amp;\".join(\n            [f\"%24{k}={v}\" for k, v in query_params.items()]\n        )\n        uri = f\"{self._base_uri}?{query_params_encoded}\"\n        logger.info(f\"Using API Endpoint: {uri}\")\n\n        result = self._data_retriever.get(uri).json()\n\n        if format == \"raw\":\n            return result\n        elif format == \"flatten\":\n            return self.flatten_workspaces(result[\"value\"])\n</code></pre>"},{"location":"references/powerbi/admin/#pbi_cli.powerbi.admin.Workspaces.__call__","title":"<code>__call__(top=1000, expand=None, filter=None, format='raw')</code>","text":"<p>See https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-groups-as-admin</p> <p>Parameters:</p> Name Type Description Default <code>top</code> <code>int</code> <p>top n results</p> <code>1000</code> <code>expand</code> <code>Optional[List[Literal['users', 'reports', 'dashboards', 'datasets', 'dataflows', 'workbooks']]]</code> <p>see official docs</p> <code>None</code> <code>filter</code> <code>Optional[str]</code> <p>odata filter, see official docs</p> <code>None</code> Source code in <code>src/pbi_cli/powerbi/admin/__init__.py</code> <pre><code>def __call__(\n    self,\n    top: int = 1000,\n    expand: Optional[\n        List[\n            Literal[\n                \"users\",\n                \"reports\",\n                \"dashboards\",\n                \"datasets\",\n                \"dataflows\",\n                \"workbooks\",\n            ]\n        ]\n    ] = None,\n    filter: Optional[str] = None,\n    format: Literal[\"raw\", \"flatten\"] = \"raw\",\n):\n    \"\"\"\n\n    See https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-groups-as-admin\n\n    :param top: top n results\n    :param expand: see official docs\n    :param filter: odata filter, see official docs\n    \"\"\"\n    query_params = {\"top\": top}\n\n    if (\n        (expand is not None)\n        and isinstance(expand, (list, tuple))\n        and len(expand) &gt;= 1\n    ):\n        query_params[\"expand\"] = \",\".join(expand)\n\n    if filter is not None:\n        query_params[\"filter\"] = filter\n\n    query_params_encoded = \"&amp;\".join(\n        [f\"%24{k}={v}\" for k, v in query_params.items()]\n    )\n    uri = f\"{self._base_uri}?{query_params_encoded}\"\n    logger.info(f\"Using API Endpoint: {uri}\")\n\n    result = self._data_retriever.get(uri).json()\n\n    if format == \"raw\":\n        return result\n    elif format == \"flatten\":\n        return self.flatten_workspaces(result[\"value\"])\n</code></pre>"},{"location":"references/powerbi/app/","title":"<code>pbi_cli.powerbi.app</code>","text":""},{"location":"references/powerbi/app/#pbi_cli.powerbi.app.App","title":"<code>App</code>","text":"<p>               Bases: <code>Base</code></p> <p>A class to interact with Power BI App</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify SSL</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/app.py</code> <pre><code>class App(Base):\n    \"\"\"\n    A class to interact with Power BI App\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify SSL\n    \"\"\"\n\n    def __init__(\n        self,\n        auth: dict,\n        app_id: str,\n        verify: bool = True,\n        app_info: Optional[dict] = None,\n    ):\n        super().__init__(auth=auth, verify=verify)\n        self.app_id = app_id\n        self.app_info = app_info\n\n    @staticmethod\n    def flatten_app(data_app: dict) -&gt; dict:\n\n        app_level_keys = [\n            k for k, v in data_app.items() if not isinstance(data_app.get(k), list)\n        ]\n        keys = [\"users\", \"reports\", \"dashboards\"]\n\n        flattened = {}\n\n        for key in keys:\n            flattened[key] = [\n                {\n                    **{\n                        app_k: v\n                        for app_k, v in data_app.items()\n                        if app_k in app_level_keys\n                    },\n                    **{f\"{key}_{d_k}\": d[d_k] for d_k in d},\n                }\n                for d in data_app.get(key, [])\n            ]\n\n        flattened[\"app\"] = [{k: v for k, v in data_app.items() if k in app_level_keys}]\n\n        return flattened\n\n    @property\n    def _base_uri(self) -&gt; str:\n        \"\"\"base uri\"\"\"\n        return f\"https://api.powerbi.com/v1.0/myorg/apps/{self.app_id}\"\n\n    @cached_property\n    def meta(self) -&gt; dict:\n        uri = f\"{self._base_uri}\"\n        result = self._data_retriever.get(uri).json()\n\n        if result.get(\"error\"):\n            raise ValueError(f\"Error: {result}\")\n\n        return result\n\n    @cached_property\n    def reports(self) -&gt; dict:\n\n        uri = f\"{self._base_uri}/reports\"\n        result = self._data_retriever.get(uri).json()\n\n        if result.get(\"error\"):\n            raise ValueError(f\"Error: {result}\")\n\n        logger.info(f\"Listing {len(result.get('value', []))} results\")\n\n        return result\n\n    @cached_property\n    def dashboards(self) -&gt; dict:\n\n        uri = f\"{self._base_uri}/dashboards\"\n        result = self._data_retriever.get(uri).json()\n\n        if result.get(\"error\"):\n            raise ValueError(f\"Error: {result}\")\n\n        logger.info(f\"Listing {len(result.get('value', []))} results\")\n\n        return result\n\n    def __call__(self):\n        result = self.meta\n        result[\"reports\"] = self.reports.get(\"value\", [])\n        result[\"dashboards\"] = self.dashboards.get(\"value\", [])\n\n        return result\n</code></pre>"},{"location":"references/powerbi/app/#pbi_cli.powerbi.app.App._base_uri","title":"<code>_base_uri</code>  <code>property</code>","text":"<p>base uri</p>"},{"location":"references/powerbi/app/#pbi_cli.powerbi.app.Apps","title":"<code>Apps</code>","text":"<p>               Bases: <code>Base</code></p> <p>A class to interact with Power BI Apps</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify SSL</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/app.py</code> <pre><code>class Apps(Base):\n    \"\"\"\n    A class to interact with Power BI Apps\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify SSL\n    \"\"\"\n\n    def __init__(\n        self, auth: dict, verify: bool = True, cache_file: Optional[Path] = None\n    ):\n        super().__init__(auth=auth, verify=verify)\n        self.cache_file = cache_file\n        self.cache = self._load_cache(self.cache_file)\n\n    @staticmethod\n    def _load_cache(cache_file: Path) -&gt; dict:\n        with open(cache_file, \"r\") as fp:\n            data = json.load(fp)\n\n        return data\n\n    @property\n    def apps(self):\n        return [\n            App(auth=self.auth, app_id=i.get(\"id\"), verify=self.verify, app_info=i)\n            for i in self.cache.get(\"value\", [])\n        ]\n\n    @property\n    def _base_uri(self) -&gt; str:\n        \"\"\"\n        Returns the base URI for Power BI Apps API.\n        \"\"\"\n        return \"https://api.powerbi.com/v1.0/myorg/apps\"\n\n    def _update_cache(self, new_data: dict) -&gt; dict:\n        cache_new = new_data\n        new_ids = [i.get(\"id\") for i in new_data.get(\"value\", [])]\n\n        cache_new[\"value\"] = [i for i in new_data.get(\"value\", [])] + [\n            i for i in self.cache.get(\"value\", []) if i.get(\"id\") not in new_ids\n        ]\n\n        self.cache = cache_new\n\n    def __call__(\n        self, format: Literal[\"raw\", \"flatten\"] = \"raw\", cache_update: bool = True\n    ):\n        uri = self._base_uri\n        result = self._data_retriever.get(uri).json()\n\n        if result.get(\"error\"):\n            raise ValueError(f\"Error: {result}\")\n\n        logger.info(f\"Listing {len(result.get('value', []))} results\")\n\n        if cache_update:\n            self._update_cache(result)\n\n        if format == \"raw\":\n            return result\n        elif format == \"flatten\":\n            return result[\"value\"]\n</code></pre>"},{"location":"references/powerbi/app/#pbi_cli.powerbi.app.Apps._base_uri","title":"<code>_base_uri</code>  <code>property</code>","text":"<p>Returns the base URI for Power BI Apps API.</p>"},{"location":"references/powerbi/base/","title":"<code>pbi_cli.powerbi.base</code>","text":""},{"location":"references/powerbi/base/#pbi_cli.powerbi.base.Base","title":"<code>Base</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract Base Class for accessing all workspaces.</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify SSL</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/base.py</code> <pre><code>class Base(ABC):\n    \"\"\"\n    Abstract Base Class for accessing all workspaces.\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify SSL\n    \"\"\"\n\n    def __init__(self, auth: dict, verify: bool = True):\n        self.auth = auth\n        self.verify = verify\n\n    @property\n    def _data_retriever(self) -&gt; DataRetriever:\n        \"\"\"\n        Returns an instance of DataRetriever configured with session query configs.\n        \"\"\"\n        return DataRetriever(\n            session_query_configs={\"headers\": self.auth, \"verify\": self.verify}\n        )\n\n    @staticmethod\n    def _encode_query_params(query_params: dict, leading_char: str = \"%24\") -&gt; str:\n        query_params_encoded = \"&amp;\".join(\n            [f\"{leading_char}{k}={v}\" for k, v in query_params.items()]\n        )\n        return query_params_encoded\n\n    @property\n    @abstractmethod\n    def _base_uri(self) -&gt; str:\n        \"\"\"\n        Abstract property to return the base URI. Must be implemented by subclasses.\n        \"\"\"\n        pass\n</code></pre>"},{"location":"references/powerbi/base/#pbi_cli.powerbi.base.Base._base_uri","title":"<code>_base_uri</code>  <code>abstractmethod</code> <code>property</code>","text":"<p>Abstract property to return the base URI. Must be implemented by subclasses.</p>"},{"location":"references/powerbi/base/#pbi_cli.powerbi.base.Base._data_retriever","title":"<code>_data_retriever</code>  <code>property</code>","text":"<p>Returns an instance of DataRetriever configured with session query configs.</p>"},{"location":"references/powerbi/io/","title":"<code>pbi_cli.powerbi.io</code>","text":""},{"location":"references/powerbi/io/#pbi_cli.powerbi.io.multi_group_dict_to_excel","title":"<code>multi_group_dict_to_excel(data, target)</code>","text":"<p>Writes a dictionary of lists into an Excel file, with each key as a worksheet.</p> <pre><code>data = {\n    \"Sheet1\": [{\"a\": 1, \"b\": 2}, {\"a\": 3, \"b\": 4}],\n    \"Sheet2\": [{\"x\": 10, \"y\": 20}, {\"x\": 30, \"y\": 40}],\n}\ndict_to_excel(data, \"output.xlsx\")\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>dict</code> <p>A dictionary where each key maps to a list of dictionaries or data.</p> required <code>file_name</code> <p>Name of the Excel file to save</p> required Source code in <code>src/pbi_cli/powerbi/io.py</code> <pre><code>def multi_group_dict_to_excel(data: dict, target: Path):\n    \"\"\"\n    Writes a dictionary of lists into an Excel file, with each key as a worksheet.\n\n    ```python\n    data = {\n        \"Sheet1\": [{\"a\": 1, \"b\": 2}, {\"a\": 3, \"b\": 4}],\n        \"Sheet2\": [{\"x\": 10, \"y\": 20}, {\"x\": 30, \"y\": 40}],\n    }\n    dict_to_excel(data, \"output.xlsx\")\n    ```\n\n    :param data: A dictionary where each key maps to a list of dictionaries or data.\n    :param file_name: Name of the Excel file to save\n    \"\"\"\n    with pd.ExcelWriter(target, engine=\"openpyxl\") as writer:\n        for sheet_name, rows in data.items():\n            df = pd.json_normalize(rows)\n            df.to_excel(writer, sheet_name=sheet_name, index=False)\n</code></pre>"},{"location":"references/powerbi/report/","title":"<code>pbi_cli.powerbi.report</code>","text":""},{"location":"references/powerbi/report/#pbi_cli.powerbi.report.Report","title":"<code>Report</code>","text":"<p>               Bases: <code>Base</code></p> <p>A class to interact with Power BI Report</p> <p>Parameters:</p> Name Type Description Default <code>auth</code> <code>dict</code> <p>dict containing the auth <code>{\"Authorization\": \"Bearer xxx\"}</code></p> required <code>verify</code> <code>bool</code> <p>whether to verify SSL</p> <code>True</code> Source code in <code>src/pbi_cli/powerbi/report.py</code> <pre><code>class Report(Base):\n    \"\"\"\n    A class to interact with Power BI Report\n\n    :param auth: dict containing the auth `{\"Authorization\": \"Bearer xxx\"}`\n    :param verify: whether to verify SSL\n    \"\"\"\n\n    def __init__(\n        self,\n        auth: dict,\n        report_id: str,\n        group_id: Optional[str] = None,\n        verify: bool = True,\n    ):\n        super().__init__(auth=auth, verify=verify)\n        self.report_id = report_id\n        self.group_id = group_id\n\n    @property\n    def _base_uri(self) -&gt; str:\n        \"\"\"\n        Returns the base URI for Power BI Apps API.\n        \"\"\"\n        if self.group_id is None:\n            return f\"https://api.powerbi.com/v1.0/myorg/reports/{self.report_id}\"\n        else:\n            return f\"https://api.powerbi.com/v1.0/myorg/groups/{self.group_id}/reports/{self.report_id}\"\n\n    def export(self):\n\n        uri = f\"{self._base_uri}/Export\"\n        req_result = self._data_retriever.get(uri)\n\n        if req_result.ok:\n            return req_result.content\n        else:\n            req_result.raise_for_status()\n</code></pre>"},{"location":"references/powerbi/report/#pbi_cli.powerbi.report.Report._base_uri","title":"<code>_base_uri</code>  <code>property</code>","text":"<p>Returns the base URI for Power BI Apps API.</p>"}]}